<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/jpeg" sizes="64x64" href="/img/icons.jpeg" />
    <title>Online Shopping</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Merienda:wght@300..900&family=Monsieur+La+Doulaise&family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>
  <body>
    <section id="header">
      <a href="#"><img src="img/logo.png" class="logo" alt="None" /></a>

      <div>
        <ul id="navbar">
          <a href="#" id="close"><i class="fa-solid fa-xmark"></i></a>
          <li>
            <a href="index.html"
              ><i class="fa-solid fa-house fa-1x"></i> Home</a
            >
          </li>
          <li>
            <a href="shop.html"><i class="fa-solid fa-store fa-1x"></i> Shop</a>
          </li>
          <li>
            <a href="blog.html"><i class="fa-solid fa-blog"></i> Blog</a>
          </li>
          <li>
            <a href="about.html"
              ><i class="fa-solid fa-address-card fa-1x"></i> About</a
            >
          </li>
          <li>
            <a href="contact.html"
              ><i class="fa-solid fa-phone fa-1x"></i> Contact</a
            >
          </li>
          <li id="lg-bag">
            <a class="active" href="cart.html"
              ><i class="fa-solid fa-cart-plus fa-1x"></i> Cart</a
            >
          </li>
          <li id="login-signup-nav">
            <a href="#" id="login-btn">Login</a> /
            <a href="#" id="signup-btn">Signup</a>
          </li>
          <li id="user-nav" style="display: none">
            <span id="user-name" style="font-weight: bold"></span
            ><a href="#" id="logout-btn" style="margin-left: 16px">Logout</a>
          </li>
        </ul>
      </div>
      <div id="mobile">
        <a href="cart.html"><i class="fa-solid fa-cart-plus fa-2x"></i></a>
        <i id="bar" class="fas fa-outdent fa-2x"></i>
      </div>
    </section>

    <section id="page-header" class="cart-head">
      <h2>My Cart</h2>
      <p>See the products that you have added on your Cart</p>
      <br />
    </section>

    <section id="cart" class="section-p1">
      <h3>
        Apply the Coupon Code <span>"SHOPSP"</span> on Shopping to get Flat
        <a>$50 Off</a>.
      </h3>
      <div class="coupon">
        <input
          type="text"
          id="coupon-code"
          placeholder="Enter coupon code if available"
        />
        <button id="apply-coupon">Apply</button>
        <p id="coupon-msg"></p>
      </div>
      <div id="cart-items"></div>
      <button class="buy" id="buy-now">Buy Now</button>
      <div id="payment-modal">
        <div
          style="
            background: #fff;
            padding: 32px;
            border-radius: 8px;
            max-width: 400px;
            margin: auto;
          "
        >
          <h3>Checkout</h3>
          <form id="payment-form">
            <div id="card-element"></div>
            <button id="submit-payment" type="submit">Pay</button>
            <div id="payment-message"></div>
          </form>
          <button
            onclick="document.getElementById('payment-modal').style.display='Order Placed!'"
          >
            Cancel
          </button>
        </div>
      </div>
      <script src="https://js.stripe.com/v3/"></script>
    </section>

    <section id="banner4">
      <div class="texts">
        <h4>Sign up for Newsletters</h4>
        <p>
          Get E-mail updates about our latest shop and
          <span>special offers.</span>
        </p>
      </div>
      <div class="email-sign">
        <input class="email" type="text" placeholder=" Your Email-ID" /><button
          class="sign"
        >
          Sign Up
        </button>
      </div>
    </section>

    <footer id="footer" class="section-p1">
      <div class="col">
        <img class="logo" src="img/logo.png" />
        <h4>Contact</h4>
        <h6><strong>Address: </strong> 22 Main St, New York, NY 10003, USA</h6>
        <h6><strong>Phone: </strong>+01 2224 322</h6>
        <h6><strong>Working Slots: </strong> 10:00 - 18:30, Mon-Sat</h6>
        <div class="follow">
          <h6>Follow Us On</h6>
          <icon>
            <i class="fa-brands fa-twitter"></i>
            <i class="fa-brands fa-instagram"></i>
            <i class="fa-brands fa-facebook"></i>
          </icon>
        </div>
      </div>
      <div class="col">
        <h4>About</h4>
        <a href="about.html">About us</a>
        <a href="privacy.html">Privacy Policy</a>
        <a href="terms.html">Terms and Condition</a>
        <a href="contact.html">Contact</a>
      </div>
      <div class="col">
        <h4>My Account</h4>
        <a href="cart.html">View Cart</a>
        <a href="#">Help</a>
      </div>
      <div class="col install">
        <h4>Secured Payment Gateways</h4>
        <img src="img/pay/pay.png" />
      </div>
      <div class="copyright">
        <p>Â© 2025, Happy Shopping - ShopSphere By Swami</p>
      </div>
    </footer>

    <script src="script.js"></script>
    <script>
      let user = JSON.parse(localStorage.getItem("user"));
      function updateNavbarAuth() {
        const loginNav = document.getElementById("login-signup-nav");
        const userNav = document.getElementById("user-nav");
        const userNameSpan = document.getElementById("user-name");
        if (user && user.username) {
          loginNav.style.display = "none";
          userNav.style.display = "";
          userNameSpan.textContent = `ðŸ‘‹ Hello ${user.username}!`;
        } else {
          loginNav.style.display = "";
          userNav.style.display = "none";
        }
      }
      updateNavbarAuth();

      document.getElementById("login-btn").onclick = function () {
        const username = prompt("Enter username:");
        const password = prompt("Enter password:");
        if (!username || !password)
          return alert("Username and password required");
        fetch("/api/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ username, password }),
        })
          .then((res) => res.json())
          .then((data) => {
            if (data.message === "Login successful") {
              user = { username };
              localStorage.setItem("user", JSON.stringify(user));
              updateNavbarAuth();
              alert("Login successful");
            } else {
              alert(data.message || "Login failed");
            }
          });
      };

      document.getElementById("signup-btn").onclick = function () {
        const username = prompt("Choose username:");
        const password = prompt("Choose password:");
        if (!username || !password)
          return alert("Username and password required");
        fetch("/api/signup", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ username, password }),
        })
          .then((res) => res.json())
          .then((data) => {
            if (data.message === "Signup successful") {
              user = { username };
              localStorage.setItem("user", JSON.stringify(user));
              updateNavbarAuth();
              alert("Signup successful");
            } else {
              alert(data.message || "Signup failed");
            }
          });
      };

      document.getElementById("logout-btn").onclick = function () {
        user = null;
        localStorage.removeItem("user");
        updateNavbarAuth();
        alert("Logged out");
        window.location.href = "index.html";
      };
    </script>
  </body>
</html>
